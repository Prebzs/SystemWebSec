#include <string.h>
#include <stdio.h>
#include <dlfcn.h>

void foo(char* src) {
  char buffer[32];
  static FILE* f;
  static char* ptr;
  f = fopen(src, "r");
  ptr = buffer;
  while ( fread(ptr++, sizeof(char), 1, f) > 0 );
  fclose(f);
}

int main(int argc, char** argv) {
  void* libc = dlopen("/lib/libc-2.7.so", RTLD_NOW);
  void* address = dlsym( libc, "__libc_init_first");
  printf("Address of <__libc_init_first>: %p\n", address);
  if(argc > 1) {
    foo(argv[1]);
  }
  printf("Done.\n");
  return 0;
}
